@model IEnumerable<ReadXML.Models.Xmldatum>
<h2>Danh sách sách</h2>

@if (!string.IsNullOrEmpty(ViewBag.ErrorMessage))
{
    <div class="alert alert-danger">
        @ViewBag.ErrorMessage
    </div>
}

@if (!string.IsNullOrEmpty(ViewBag.SuccessMessage))
{
    <div class="alert alert-success">
        @ViewBag.SuccessMessage
    </div>
}

<form asp-action="ReadXML" method="post" enctype="multipart/form-data">
    <div class="form-group">
        <label for="file">Chọn file XML:</label>
        <input type="file" name="file" class="form-control" accept=".xml" required />
    </div>
    <div class="mt-3">
        <button type="submit" class="btn btn-primary">Preview data</button>

    </div>

   
</form>

@if (Model != null && Model.Any())
{
    <form asp-action="SaveToDatabase" method="post">
        <input type="hidden" name="xmlData" value="@ViewBag.XmlRaw" />
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Author</th>
                    <th>Title</th>
                    <th>Genre</th>
                    <th>Price</th>
                    <th>Publish Date</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var book in Model)
                {
                    <tr>
                        <td>@(book.Author ?? "N/A")</td>
                        <td>@(book.Title ?? "N/A")</td>
                        <td>@(book.Genre ?? "N/A")</td>
                        <td>@(book.Price.HasValue ? book.Price.Value.ToString("C") : "N/A")</td>
                        <td>@(book.PublishDate.HasValue ? book.PublishDate.Value.ToString("yyyy-MM-dd") : "N/A")</td>
                    </tr>
                }
            </tbody>
        </table>
        <button type="submit" class="btn btn-success">Save to Database</button>
    </form>
}
else
{
    <div class="alert alert-info">
        Không có dữ liệu sách để hiển thị.
    </div>
}